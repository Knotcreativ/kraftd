var E=Object.defineProperty;var A=(r,t,s)=>t in r?E(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var b=(r,t,s)=>A(r,typeof t!="symbol"?t+"":t,s);import{r as u,a as L,b as P}from"./react-vendor-BIF_SMrh.js";import{u as T,B as _,R as C,a as v,N as S}from"./router-BUpocWfK.js";import{a as O}from"./api-B9ygI19o.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();var k={exports:{}},j={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U=u,F=Symbol.for("react.element"),$=Symbol.for("react.fragment"),B=Object.prototype.hasOwnProperty,q=U.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,M={key:!0,ref:!0,__self:!0,__source:!0};function I(r,t,s){var a,n={},o=null,i=null;s!==void 0&&(o=""+s),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(a in t)B.call(t,a)&&!M.hasOwnProperty(a)&&(n[a]=t[a]);if(r&&r.defaultProps)for(a in t=r.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:F,type:r,key:o,ref:i,props:n,_owner:q.current}}j.Fragment=$;j.jsx=I;j.jsxs=I;k.exports=j;var e=k.exports,w={},N=L;w.createRoot=N.createRoot,w.hydrateRoot=N.hydrateRoot;const W="https://kraftdintel-app.nicerock-74b0737d.uaenorth.azurecontainerapps.io/api/v1";class z{constructor(){b(this,"client");this.client=O.create({baseURL:W,timeout:1e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(t=>{const s=localStorage.getItem("accessToken");return s&&(t.headers.Authorization=`Bearer ${s}`),t}),this.client.interceptors.response.use(t=>t,async t=>{var s;if(((s=t.response)==null?void 0:s.status)===401){const a=localStorage.getItem("refreshToken");if(a)try{const n=await this.client.post("/auth/refresh-token",{refreshToken:a}),{accessToken:o}=n.data;if(localStorage.setItem("accessToken",o),t.config)return t.config.headers.Authorization=`Bearer ${o}`,this.client(t.config)}catch{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/login"}}return Promise.reject(t)})}async register(t,s){return(await this.client.post("/auth/register",{email:t,password:s})).data}async login(t,s){return(await this.client.post("/auth/login",{email:t,password:s})).data}async refreshToken(t){return(await this.client.post("/auth/refresh-token",{refreshToken:t})).data}async uploadDocument(t){const s=new FormData;return s.append("file",t),(await this.client.post("/documents/upload",s,{headers:{"Content-Type":"multipart/form-data"}})).data}async getDocument(t){return(await this.client.get(`/documents/${t}`)).data}async listDocuments(){return(await this.client.get("/documents")).data}async updateDocument(t,s){return(await this.client.put(`/documents/${t}`,s)).data}async deleteDocument(t){await this.client.delete(`/documents/${t}`)}async startWorkflow(t){return(await this.client.post("/workflows/start",{documentId:t})).data}async getWorkflow(t){return(await this.client.get(`/workflows/${t}`)).data}async updateWorkflowStatus(t,s){return(await this.client.put(`/workflows/${t}/status`,{status:s})).data}async getHealth(){return(await this.client.get("/health")).status===200}}const x=new z,R=u.createContext(void 0);function K({children:r}){const[t,s]=u.useState(!1),[a,n]=u.useState(!0),[o,i]=u.useState(null);u.useEffect(()=>{const d=localStorage.getItem("accessToken");s(!!d),n(!1)},[]);const h=d=>{localStorage.setItem("accessToken",d.accessToken),localStorage.setItem("refreshToken",d.refreshToken),localStorage.setItem("expiresAt",(Date.now()+d.expiresIn*1e3).toString()),s(!0),i(null)},m=async(d,l)=>{n(!0),i(null);try{const c=await x.login(d,l);h(c)}catch(c){const y=c instanceof Error?c.message:"Login failed";throw i(y),c}finally{n(!1)}},p=async(d,l)=>{n(!0),i(null);try{const c=await x.register(d,l);h(c)}catch(c){const y=c instanceof Error?c.message:"Registration failed";throw i(y),c}finally{n(!1)}},f=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("expiresAt"),s(!1),i(null)},g=()=>i(null);return e.jsx(R.Provider,{value:{isAuthenticated:t,isLoading:a,error:o,login:m,register:p,logout:f,clearError:g},children:r})}function D(){const r=u.useContext(R);if(!r)throw new Error("useAuth must be used within AuthProvider");return r}function Y(){const[r,t]=u.useState(""),[s,a]=u.useState(""),[n,o]=u.useState(!1),[i,h]=u.useState(!1),{login:m,register:p}=D(),f=T(),g=async d=>{d.preventDefault(),h(!0);try{n?await p(r,s):await m(r,s),f("/dashboard")}catch(l){console.error(n?"Registration failed":"Login failed",l)}finally{h(!1)}};return e.jsx("div",{className:"login-container",children:e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("h1",{children:"KraftdIntel"}),e.jsx("p",{children:"Intelligent Procurement Management"})]}),e.jsxs("form",{onSubmit:g,className:"login-form",children:[e.jsx("h2",{children:n?"Create Account":"Sign In"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email Address"}),e.jsx("input",{id:"email",type:"email",value:r,onChange:d=>t(d.target.value),placeholder:"your@email.com",required:!0,disabled:i})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{id:"password",type:"password",value:s,onChange:d=>a(d.target.value),placeholder:"••••••••",required:!0,disabled:i})]}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:i,children:i?"Processing...":n?"Create Account":"Sign In"}),e.jsx("button",{type:"button",className:"btn-link",onClick:()=>o(!n),disabled:i,children:n?"Already have an account? Sign In":"Need an account? Register"})]}),e.jsx("div",{className:"login-footer",children:e.jsx("p",{children:"Secure. Efficient. Intelligent."})})]})})}function H(){const[r,t]=u.useState([]),[s,a]=u.useState(!0),[n,o]=u.useState(null),[i,h]=u.useState(null),[m,p]=u.useState(!1);u.useEffect(()=>{f()},[]);const f=async()=>{a(!0),o(null);try{const l=await x.listDocuments();t(l)}catch(l){o("Failed to load documents"),console.error(l)}finally{a(!1)}},g=l=>{var c;(c=l.target.files)!=null&&c[0]&&h(l.target.files[0])},d=async l=>{if(l.preventDefault(),!!i){p(!0);try{const c=await x.uploadDocument(i);t([c,...r]),h(null)}catch(c){o("Upload failed"),console.error(c)}finally{p(!1)}}};return e.jsxs("div",{className:"dashboard",children:[e.jsx("h1",{children:"Documents & Procurement Management"}),e.jsxs("div",{className:"dashboard-content",children:[e.jsxs("div",{className:"upload-section",children:[e.jsx("h2",{children:"Upload Document"}),e.jsxs("form",{onSubmit:d,className:"upload-form",children:[e.jsxs("div",{className:"file-input-wrapper",children:[e.jsx("input",{type:"file",onChange:g,disabled:m,id:"file-input"}),e.jsx("label",{htmlFor:"file-input",className:"file-label",children:i?i.name:"Select a file or drag and drop"})]}),e.jsx("button",{type:"submit",disabled:!i||m,className:"btn-upload",children:m?"Uploading...":"Upload"})]})]}),e.jsxs("div",{className:"documents-section",children:[e.jsx("h2",{children:"Your Documents"}),n&&e.jsx("div",{className:"error-message",children:n}),s?e.jsx("div",{className:"loading",children:"Loading documents..."}):r.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"No documents uploaded yet"}),e.jsx("p",{className:"hint",children:"Upload your first document above to get started"})]}):e.jsx("div",{className:"documents-grid",children:r.map(l=>e.jsxs("div",{className:"document-card",children:[e.jsxs("div",{className:"doc-header",children:[e.jsx("h3",{children:l.name}),e.jsx("span",{className:`status ${l.status}`,children:l.status})]}),e.jsxs("p",{className:"doc-meta",children:["Uploaded: ",new Date(l.uploadedAt).toLocaleDateString()]}),e.jsxs("div",{className:"doc-actions",children:[e.jsx("button",{className:"btn-view",children:"View"}),e.jsx("button",{className:"btn-workflow",children:"Start Workflow"})]})]},l.id))})]})]})]})}function J({children:r}){return e.jsxs("div",{className:"layout",children:[e.jsxs("nav",{className:"navbar",children:[e.jsxs("div",{className:"navbar-brand",children:[e.jsx("h1",{children:"KraftdIntel"}),e.jsx("p",{className:"tagline",children:"Intelligent Procurement Management"})]}),e.jsxs("div",{className:"navbar-menu",children:[e.jsx("a",{href:"/dashboard",className:"nav-link",children:"Dashboard"}),e.jsx("a",{href:"/profile",className:"nav-link",children:"Profile"}),e.jsx("a",{href:"/logout",className:"nav-link logout",children:"Logout"})]})]}),e.jsx("main",{className:"main-content",children:r})]})}function V({children:r}){const{isAuthenticated:t}=D();return t?e.jsx(e.Fragment,{children:r}):e.jsx(S,{to:"/login"})}function G(){return e.jsx(_,{children:e.jsx(K,{children:e.jsxs(C,{children:[e.jsx(v,{path:"/login",element:e.jsx(Y,{})}),e.jsx(v,{path:"/dashboard",element:e.jsx(V,{children:e.jsx(J,{children:e.jsx(H,{})})})}),e.jsx(v,{path:"/",element:e.jsx(S,{to:"/dashboard"})})]})})})}w.createRoot(document.getElementById("root")).render(e.jsx(P.StrictMode,{children:e.jsx(G,{})}));
